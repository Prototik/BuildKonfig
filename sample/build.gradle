apply plugin: 'org.jetbrains.kotlin.multiplatform'
apply plugin: 'com.codingfeline.buildkonfig'

buildscript {
    repositories {
        // Use 'gradle install' to install latest
        maven { url "file://${projectDir.absolutePath}/../build/localMaven" }
        mavenLocal()
        mavenCentral()
    }

    dependencies {
        classpath 'org.jetbrains.kotlin:kotlin-gradle-plugin:1.5.21'
        classpath 'com.codingfeline.buildkonfig:buildkonfig-gradle-plugin:+'
    }
}

allprojects {
    repositories {
        mavenCentral()
    }
}

kotlin {
    jvm {}
    js(IR) {
        browser()
        nodejs()
    }
    ios()
}

buildkonfig {
    packageName = 'com.codingfeline.buildkonfigsample'

    defaultConfigs {
        buildConfigField 'STRING', 'test', 'testvalue'
        buildConfigField 'STRING', 'target', 'common'
    }

    targetConfigs {
        jvm {
            buildConfigField 'STRING', 'target', 'jvm'
        }
        // KMP plugin internally creates iosArm64 and iosX64 targets
        // when we use `ios()`. So we need to configure both targets.
        iosArm64 {
            buildConfigField 'STRING', 'target', 'iosArm64'
        }
        iosX64 {
            buildConfigField 'STRING', 'target', 'iosX64'
        }
    }
}
